%%
%%  wpc_polyhedron.erl --
%%
%%     Polyhedron
%%
%%  Copyright (c) 2024 Iban Oyharcabal | Corentin Seutin
%%
%%  See the file "license.terms" for information on usage and redistribution
%%  of this file, and for a DISCLAIMER OF ALL WARRANTIES.
%%
%%     $Id$
%%

-module(wpc_polyhedron).
-export([init/0, menu/2, command/2]).
-include_lib("wings/src/wings.hrl").
-import(lists, [reverse/1]).

init() -> true.

menu({shape}, []) ->
    [];
menu({shape}, Menu) ->
    Menu;
menu(_, Menu) -> Menu.

command({shape,{polyhedron, Arg}}, St) -> make_polyhedron(Arg, St);
command(_, _) -> next.

%%% The rest are local functions.

make_polyhedron(Arg, St) when is_atom(Arg) ->
    wings_dialog:dialog_preview({shape,polyhedron}, Arg, ?__(1,"Polyhedron Options"), dialog(), St);
make_polyhedron(Arg, _) ->
    ArgDict = dict:from_list(Arg),
    BaseFlag = dict:fetch(baseflag, ArgDict),
    TruncatedFlag = dict:fetch(truncated, ArgDict),
    NormalizedFlag = dict:fetch(normalized, ArgDict),
    Rot_X = dict:fetch(rot_x, ArgDict),
    Rot_Y = dict:fetch(rot_y, ArgDict),
    Rot_Z = dict:fetch(rot_z, ArgDict),
    Mov_X = dict:fetch(mov_x, ArgDict),
    Mov_Y = dict:fetch(mov_y, ArgDict),
    Mov_Z = dict:fetch(mov_z, ArgDict),
    Ground = dict:fetch(ground, ArgDict),

    {Verts, Faces} = polyhedron_main(BaseFlag, TruncatedFlag, NormalizedFlag),    
    Vs = wings_shapes:transform_obj({Rot_X,Rot_Y,Rot_Z},{Mov_X,Mov_Y,Mov_Z}, Ground, Verts),
    Name = ?__(2,":polyhedron"),
    ObjName = [Name],
    {new_shape, ObjName, Faces, Vs}.

dialog() ->
    TruncatedFlag = get_pref(truncated, false),
    NormalizedFlag = get_pref(normalized, true),
    [
        {vframe,[polyhedron_types()],[{title,?__(1,"Type")}]},
        {?__(2,"Truncated"), TruncatedFlag, [{key, truncated}]},
        {?__(3,"Normalized"), NormalizedFlag, [{key, normalized}]},
     wings_shapes:transform_obj_dlg()
    ].

polyhedron_types() ->
    BaseFlag = get_pref(baseflag, tetrahedron),
    {menu,[{?__(1,"Tetrahedron"), tetrahedron},
            {?__(2,"Hexahedron"), hexahedron},
	        {?__(3,"Octahedron"), octahedron},
	        {?__(4,"Icosahedron"), icosahedron},
            {?__(5,"Dodecahedron"), dodecahedron},
            {?__(6,"Hexaoctahedron"), hexaoctahedron},
	        {?__(7,"Rhombi Hexaoctahedron"), rhombi_hexaoctahedron},
            {?__(8,"Left Snub Hexaoctahedron"), left_snub_hexaoctahedron},
            {?__(9,"Right Snub Hexaoctahedron"), right_snub_hexaoctahedron},
            {?__(10,"Icosadodecahedron"), icosadodecahedron},
	        {?__(11,"Rhombi Icosadodecahedron"), rhombi_icosadodecahedron},
            {?__(12,"Left Snub Icosadodecahedron"), left_snub_icosadodecahedron},
            {?__(13,"Right Snub Icosadodecahedron"), right_snub_icosadodecahedron}],
     BaseFlag,
     [{key,baseflag}]}.


polyhedron_main(BaseFlag, TruncatedFlag, NormalizedFlag) ->
    case BaseFlag of
	tetrahedron -> {Verts, Faces} = tetrahedron(TruncatedFlag);
	hexahedron -> {Verts, Faces} = hexahedron(TruncatedFlag);
	octahedron  -> {Verts, Faces} = octahedron(TruncatedFlag);
	icosahedron -> {Verts, Faces} = icosahedron(TruncatedFlag);
	dodecahedron -> {Verts, Faces} = dodecahedron(TruncatedFlag);

	hexaoctahedron -> {Verts, Faces} = hexaoctahedron(TruncatedFlag);
	rhombi_hexaoctahedron -> {Verts, Faces} = rhombi_hexaoctahedron(TruncatedFlag);
	left_snub_hexaoctahedron -> {Verts, Faces} = left_snub_hexaoctahedron(TruncatedFlag);
	right_snub_hexaoctahedron -> {Verts, Faces} = right_snub_hexaoctahedron(TruncatedFlag);

	icosadodecahedron -> {Verts, Faces} = icosadodecahedron(TruncatedFlag);
	rhombi_icosadodecahedron -> {Verts, Faces} = rhombi_icosadodecahedron(TruncatedFlag);
	left_snub_icosadodecahedron -> {Verts, Faces} = left_snub_icosadodecahedron(TruncatedFlag);
	right_snub_icosadodecahedron -> {Verts, Faces} = right_snub_icosadodecahedron(TruncatedFlag)
    end,

    case NormalizedFlag of
        true -> Verts2 = normalize(Verts);
        false -> Verts2 = Verts
    end,
    {Verts2, Faces}.


tetrahedron(false) ->
    Verts = [
    {0.0,0.47628967,0.0}, {0.0,-0.34020691,0.57735027}, 
    {-0.5,-0.34020691,-0.28867513}, {0.5,-0.34020691,-0.28867513}],
    Faces = [[0,2,1], [0,3,2], [1,3,0], [2,3,1]],
    {Verts,Faces};
tetrahedron(true) ->
    Verts = [{-0.5,-0.61237244,0.8660254}, {-1.0,-0.61237244,-math:exp(-08)}, {0.0,0.20412415,1.15470052}, 
    {-1.0,0.20412415,-0.57735029}, {0.0,1.02062073,0.57735024}, {-0.5,1.02062073,-0.28867516}, 
    {0.5,-0.61237244,0.86602537}, {-0.5,-0.61237244,-0.86602543}, {0.5,1.02062073,-0.28867517}, 
    {1.0,-0.61237244,-5*math:exp(-08)}, {0.5,-0.61237244,-0.86602546}, {1.0,0.20412415,-0.57735031}],
    Faces = [[0,2,4,5,3,1], [0,6,2], [1,7,10,9,6,0], [2,6,9,11,8,4], 
    [3,7,1], [4,8,5], [5,8,11,10,7,3], [10,11,9]],
    {Verts,Faces}.

hexahedron(false) ->
    Verts = [
    {-0.5,-0.5,-0.5}, {-0.5,-0.5,0.5}, {-0.5,0.5,-0.5}, 
    {-0.5,0.5,0.5}, {0.5,-0.5,-0.5}, {0.5,-0.5,0.5}, 
    {0.5,0.5,-0.5}, {0.5,0.5,0.5}],
    Faces = [[0,4,5,1], [1,3,2,0], [1,5,7,3], [2,6,4,0], 
    [3,7,6,2], [4,6,7,5]],
    {Verts,Faces};
hexahedron(true) ->
    Verts = [{-1.20710678,-1.20710678,-0.5}, {-1.20710678,-1.20710678,0.5}, {-1.20710678,-0.5,-1.20710678}, 
    {-1.20710678,-0.5,1.20710678}, {-1.20710678,0.5,-1.20710678}, {-1.20710678,0.5,1.20710678}, 
    {-1.20710678,1.20710678,-0.5}, {-1.20710678,1.20710678,0.5}, {-0.5,-1.20710678,-1.20710678}, 
    {-0.5,-1.20710678,1.20710678}, {-0.5,1.20710678,-1.20710678}, {-0.5,1.20710678,1.20710678}, 
    {0.5,-1.20710678,-1.20710678}, {0.5,-1.20710678,1.20710678}, {0.5,1.20710678,-1.20710678}, 
    {0.5,1.20710678,1.20710678}, {1.20710678,-1.20710678,-0.5}, {1.20710678,-1.20710678,0.5}, 
    {1.20710678,-0.5,-1.20710678}, {1.20710678,-0.5,1.20710678}, {1.20710678,0.5,-1.20710678}, 
    {1.20710678,0.5,1.20710678}, {1.20710678,1.20710678,-0.5}, {1.20710678,1.20710678,0.5}],
    Faces = [[0,8,12,16,17,13,9,1], [1,3,5,7,6,4,2,0], [1,9,3], [2,8,0], 
    [3,9,13,19,21,15,11,5], [4,10,14,20,18,12,8,2], [5,11,7], [6,10,4], 
    [7,11,15,23,22,14,10,6], [12,18,16], [14,22,20], 
    [16,18,20,22,23,21,19,17], [17,19,13], [21,23,15]],
    {Verts,Faces}.

octahedron(false) ->
    Verts = [{0.70710678,0.0,0.0}, {-0.70710678,0.0,0.0}, 
    {0.0,0.70710678,0.0}, {0.0,-0.70710678,0.0}, 
    {0.0,0.0,0.70710678}, {0.0,0.0,-0.70710678}],
    Faces = [[0,4,3], [0,5,2], [1,4,2], [1,5,3], 
    [2,4,0], [2,5,1], [3,4,1], [3,5,0]],
    {Verts,Faces};
octahedron(true) ->
    Verts = [{-1.5,-0.5,0.0}, {-1.5,0.5,0.0}, {-1.0,-1.0,-0.70710678}, 
    {-1.0,-1.0,0.70710678}, {-1.0,1.0,-0.70710678}, {-1.0,1.0,0.70710678}, 
    {-0.5,-1.5,0.0}, {-0.5,-0.5,-1.41421356}, {-0.5,-0.5,1.41421356}, 
    {-0.5,0.5,-1.41421356}, {-0.5,0.5,1.41421356}, {-0.5,1.5,0.0}, 
    {0.5,-1.5,0.0}, {0.5,-0.5,-1.41421356}, {0.5,-0.5,1.41421356}, 
    {0.5,0.5,-1.41421356}, {0.5,0.5,1.41421356}, {0.5,1.5,0.0}, 
    {1.0,-1.0,-0.70710678}, {1.0,-1.0,0.70710678}, {1.0,1.0,-0.70710678}, 
    {1.0,1.0,0.70710678}, {1.5,-0.5,0.0}, {1.5,0.5,0.0}],
    Faces = [[0,3,8,10,5,1], [1,4,9,7,2,0], [1,5,11,4], [2,6,3,0], 
    [2,7,13,18,12,6], [4,11,17,20,15,9], [6,12,19,14,8,3], [8,14,16,10], 
    [9,15,13,7], [10,16,21,17,11,5], [14,19,22,23,21,16], [15,20,23,22,18,13], 
    [17,21,23,20], [18,22,19,12]],
    {Verts,Faces}.

icosahedron(false) ->
    Verts = [{0.0,0.95105652,0.0}, {0.85065081,0.4253254,0.0}, {0.26286556,0.4253254,0.80901699}, 
    {-0.68819096,0.4253254,0.5}, {-0.68819096,0.4253254,-0.5}, {0.26286556,0.4253254,-0.80901699}, 
    {-0.85065081,-0.4253254,0.0}, {-0.26286556,-0.4253254,-0.80901699}, {0.68819096,-0.4253254,-0.5}, 
    {0.68819096,-0.4253254,0.5}, {-0.26286556,-0.4253254,0.80901699}, {0.0,-0.95105652,0.0}],
    Faces = [[0,2,1], [0,3,2], [0,4,3], [0,5,4], [1,5,0], [1,8,5], 
    [1,9,8], [2,9,1], [2,10,9], [3,10,2], [4,6,3], [4,7,6], [5,7,4], 
    [5,8,7], [6,10,3], [6,11,10], [7,11,6], [8,11,7], [9,11,8], [10,11,9]],
    {Verts,Faces};
icosahedron(true) ->
    Verts = [{-2.38949261,-0.5,-0.42532539}, {-2.38949261,0.5,-0.42532539}, {-2.22703266,-1.0,0.42532539}, 
    {-2.22703266,1.0,0.42532539}, {-2.06457291,-0.5,1.27597618}, {-2.06457291,0.5,1.27597618}, 
    {-1.96416721,-0.80901699,-1.27597618}, {-1.96416721,0.80901699,-1.27597618}, {-1.70130157,0.0,-1.80170727}, 
    {-1.63924751,-1.80901699,0.42532539}, {-1.63924751,1.80901699,0.42532539}, {-1.37638187,-1.61803398,-1.27597618}, 
    {-1.37638187,-1.0,1.80170727}, {-1.37638187,1.0,1.80170727}, {-1.37638187,1.61803398,-1.27597618}, 
    {-1.21392212,-2.11803398,-0.42532539}, {-1.21392212,2.11803398,-0.42532539}, {-1.11351633,-1.80901699,1.27597618}, 
    {-1.11351633,1.80901699,1.27597618}, {-0.85065079,0.0,-2.32743835}, {-0.68819094,-0.5,2.32743835}, 
    {-0.68819094,0.5,2.32743835}, {-0.52573113,-1.61803398,-1.80170727}, {-0.52573113,1.61803398,-1.80170727}, 
    {-0.26286557,-2.42705097,-0.42532539}, {-0.26286557,-0.80901699,-2.32743835}, {-0.26286557,0.80901699,-2.32743835}, 
    {-0.26286557,2.42705097,-0.42532539}, {-0.16245985,-2.11803398,1.27597618}, {-0.16245985,2.11803398,1.27597618}, 
    {0.16245985,-2.11803398,-1.27597618}, {0.16245985,2.11803398,-1.27597618}, {0.26286557,-2.42705097,0.42532539}, 
    {0.26286557,-0.80901699,2.32743835}, {0.26286557,0.80901699,2.32743835}, {0.26286557,2.42705097,0.42532539}, 
    {0.52573113,-1.61803398,1.80170727}, {0.52573113,1.61803398,1.80170727}, {0.68819094,-0.5,-2.32743835}, 
    {0.68819094,0.5,-2.32743835}, {0.85065079,0.0,2.32743835}, {1.11351633,-1.80901699,-1.27597618}, 
    {1.11351633,1.80901699,-1.27597618}, {1.21392212,-2.11803398,0.42532539}, {1.21392212,2.11803398,0.42532539}, 
    {1.37638187,-1.61803398,1.27597618}, {1.37638187,-1.0,-1.80170727}, {1.37638187,1.0,-1.80170727}, 
    {1.37638187,1.61803398,1.27597618}, {1.63924751,-1.80901699,-0.42532539}, {1.63924751,1.80901699,-0.42532539}, 
    {1.70130157,0.0,1.80170727}, {1.96416721,-0.80901699,1.27597618}, {1.96416721,0.80901699,1.27597618}, 
    {2.06457291,-0.5,-1.27597618}, {2.06457291,0.5,-1.27597618}, {2.22703266,-1.0,-0.42532539}, {2.22703266,1.0,-0.42532539}, 
    {2.38949261,-0.5,0.42532539}, {2.38949261,0.5,0.42532539}],
    Faces = [[0,2,4,5,3,1], [0,6,11,15,9,2], [1,7,8,6,0], [2,9,17,12,4], [3,10,16,14,7,1], 
    [4,12,20,21,13,5], [5,13,18,10,3], [7,14,23,26,19,8], [8,19,25,22,11,6], [10,18,29,35,27,16], 
    [11,22,30,24,15], [13,21,34,37,29,18], [15,24,32,28,17,9], [16,27,31,23,14], [17,28,36,33,20,12], 
    [19,26,39,38,25], [20,33,40,34,21], [23,31,42,47,39,26], [25,38,46,41,30,22], [27,35,44,50,42,31], 
    [29,37,48,44,35], [30,41,49,43,32,24], [32,43,45,36,28], [34,40,51,53,48,37], [36,45,52,51,40,33], 
    [39,47,55,54,46,38], [42,50,57,55,47], [43,49,56,58,52,45], [46,54,56,49,41], [48,53,59,57,50,44], 
    [52,58,59,53,51], [55,57,59,58,56,54]],
    {Verts,Faces}.

dodecahedron(false) -> 
    Verts = [{-0.5,0.0,1.30901699}, {0.5,0.0,1.30901699}, {-0.80901699,-0.80901699,-0.80901699}, 
    {-0.80901699,-0.80901699,0.80901699}, {-0.80901699,0.80901699,-0.80901699}, 
    {-0.80901699,0.80901699,0.80901699}, {0.80901699,-0.80901699,-0.80901699}, 
    {0.80901699,-0.80901699,0.80901699}, {0.80901699,0.80901699,-0.80901699}, 
    {0.80901699,0.80901699,0.80901699}, {1.30901699,0.5,0.0}, {1.30901699,-0.5,0.0}, 
    {-1.30901699,0.5,0.0}, {-1.30901699,-0.5,0.0}, {-0.5,0.0,-1.30901699}, {0.5,0.0,-1.30901699}, 
    {0.0,1.30901699,0.5}, {0.0,1.30901699,-0.5}, {0.0,-1.30901699,0.5}, {0.0,-1.30901699,-0.5}],
    Faces = [[0,3,18,7,1], [0,5,12,13,3], [1,9,16,5,0], [2,19,18,3,13], [4,17,8,15,14], 
    [6,15,8,10,11], [7,11,10,9,1], [8,17,16,9,10], [11,7,18,19,6], [12,5,16,17,4], 
    [13,12,4,14,2], [14,15,6,19,2]],
    {Verts,Faces};
dodecahedron(true) ->
    Verts = [{-2.91522369,-0.5,-0.26286557}, {-2.91522369,0.5,-0.26286557}, {-2.75276375,0.0,-1.11351633}, 
    {-2.65235806,-1.30901699,0.26286557}, {-2.65235806,1.30901699,0.26286557}, {-2.22703266,-1.61803398,1.11351633}, 
    {-2.22703266,0.0,-1.96416721}, {-2.22703266,1.61803398,1.11351633}, {-2.06457291,-2.11803398,0.26286557}, 
    {-2.06457291,2.11803398,0.26286557}, {-1.80170727,-1.30901699,1.96416721}, {-1.80170727,1.30901699,1.96416721}, 
    {-1.53884172,-0.5,-2.4898983}, {-1.53884172,-0.5,2.4898983}, {-1.53884172,0.5,-2.4898983}, {-1.53884172,0.5,2.4898983}, 
    {-1.37638187,-2.61803398,-0.26286557}, {-1.37638187,2.61803398,-0.26286557}, {-0.95105648,-1.30901699,-2.4898983}, 
    {-0.95105648,-1.30901699,2.4898983}, {-0.95105648,1.30901699,-2.4898983}, {-0.95105648,1.30901699,2.4898983}, 
    {-0.85065079,-2.61803398,-1.11351633}, {-0.85065079,2.61803398,-1.11351633}, {-0.68819094,-2.11803398,-1.96416721}, 
    {-0.68819094,2.11803398,-1.96416721}, {-0.42532539,-2.92705097,-0.26286557}, {-0.42532539,2.92705097,-0.26286557}, 
    {0.0,-1.61803398,-2.4898983}, {0.0,-1.61803398,2.4898983}, {0.0,1.61803398,-2.4898983}, {0.0,1.61803398,2.4898983}, 
    {0.42532539,-2.92705097,0.26286557}, {0.42532539,2.92705097,0.26286557}, {0.68819094,-2.11803398,1.96416721}, 
    {0.68819094,2.11803398,1.96416721}, {0.85065079,-2.61803398,1.11351633}, {0.85065079,2.61803398,1.11351633}, 
    {0.95105648,-1.30901699,-2.4898983}, {0.95105648,-1.30901699,2.4898983}, {0.95105648,1.30901699,-2.4898983}, 
    {0.95105648,1.30901699,2.4898983}, {1.37638187,-2.61803398,0.26286557}, {1.37638187,2.61803398,0.26286557}, 
    {1.53884172,-0.5,-2.4898983}, {1.53884172,-0.5,2.4898983}, {1.53884172,0.5,-2.4898983}, {1.53884172,0.5,2.4898983}, 
    {1.80170727,-1.30901699,-1.96416721}, {1.80170727,1.30901699,-1.96416721}, {2.06457291,-2.11803398,-0.26286557}, 
    {2.06457291,2.11803398,-0.26286557}, {2.22703266,-1.61803398,-1.11351633}, {2.22703266,0.0,1.96416721}, 
    {2.22703266,1.61803398,-1.11351633}, {2.65235806,-1.30901699,-0.26286557}, {2.65235806,1.30901699,-0.26286557}, 
    {2.75276375,0.0,1.11351633}, {2.91522369,-0.5,0.26286557}, {2.91522369,0.5,0.26286557}],
    Faces = [[0,3,5,10,13,15,11,7,4,1], [1,2,0], [1,4,9,17,23,25,20,14,6,2], [2,6,12,18,24,22,16,8,3,0], 
    [3,8,5], [6,14,12], [7,9,4], [7,11,21,31,35,37,33,27,17,9], [8,16,26,32,36,34,29,19,10,5], [10,19,13], 
    [13,19,29,39,45,47,41,31,21,15], [14,20,30,40,46,44,38,28,18,12], [15,21,11], [17,27,23], [18,28,24], 
    [22,26,16], [23,27,33,43,51,54,49,40,30,25], [24,28,38,48,52,50,42,32,26,22], [25,30,20], [31,41,35], 
    [32,42,36], [34,39,29], [35,41,47,53,57,59,56,51,43,37], [36,42,50,55,58,57,53,45,39,34], [37,43,33], 
    [40,49,46], [44,48,38], [45,53,47], [46,49,54,56,59,58,55,52,48,44], [51,56,54], [52,55,50], [58,59,57]],
    {Verts,Faces}.

hexaoctahedron(false) ->
    Verts = [{-1.0,0.0,0.0}, {-0.5,-0.5,-0.70710678}, {-0.5,-0.5,0.70710678}, {-0.5,0.5,-0.70710678}, 
    {-0.5,0.5,0.70710678}, {0.0,-1.0,0.0}, {0.0,1.0,0.0}, {0.5,-0.5,-0.70710678}, {0.5,-0.5,0.70710678}, 
    {0.5,0.5,-0.70710678}, {0.5,0.5,0.70710678}, {1.0,0.0,0.0}],
    Faces = [[0,3,1], [0,4,6,3], [1,5,2,0], [1,7,5], [2,4,0], [2,8,10,4], [3,9,7,1], [4,10,6], 
    [5,8,2], [6,9,3], [6,10,11,9], [7,11,8,5], [8,11,10], [9,11,7]],
    {Verts,Faces};
hexaoctahedron(true) ->
    Verts = [{-1.91421356,-1.20710678,-0.5}, {-1.91421356,-1.20710678,0.5}, {-1.91421356,-0.5,-1.20710678}, 
    {-1.91421356,-0.5,1.20710678}, {-1.91421356,0.5,-1.20710678}, {-1.91421356,0.5,1.20710678}, 
    {-1.91421356,1.20710678,-0.5}, {-1.91421356,1.20710678,0.5}, {-1.20710678,-1.91421356,-0.5}, 
    {-1.20710678,-1.91421356,0.5}, {-1.20710678,-0.5,-1.91421356}, {-1.20710678,-0.5,1.91421356}, 
    {-1.20710678,0.5,-1.91421356}, {-1.20710678,0.5,1.91421356}, {-1.20710678,1.91421356,-0.5}, 
    {-1.20710678,1.91421356,0.5}, {-0.5,-1.91421356,-1.20710678}, {-0.5,-1.91421356,1.20710678}, 
    {-0.5,-1.20710678,-1.91421356}, {-0.5,-1.20710678,1.91421356}, {-0.5,1.20710678,-1.91421356}, 
    {-0.5,1.20710678,1.91421356}, {-0.5,1.91421356,-1.20710678}, {-0.5,1.91421356,1.20710678}, 
    {0.5,-1.91421356,-1.20710678}, {0.5,-1.91421356,1.20710678}, {0.5,-1.20710678,-1.91421356}, 
    {0.5,-1.20710678,1.91421356}, {0.5,1.20710678,-1.91421356}, {0.5,1.20710678,1.91421356}, 
    {0.5,1.91421356,-1.20710678}, {0.5,1.91421356,1.20710678}, {1.20710678,-1.91421356,-0.5}, 
    {1.20710678,-1.91421356,0.5}, {1.20710678,-0.5,-1.91421356}, {1.20710678,-0.5,1.91421356}, 
    {1.20710678,0.5,-1.91421356}, {1.20710678,0.5,1.91421356}, {1.20710678,1.91421356,-0.5}, 
    {1.20710678,1.91421356,0.5}, {1.91421356,-1.20710678,-0.5}, {1.91421356,-1.20710678,0.5}, 
    {1.91421356,-0.5,-1.20710678}, {1.91421356,-0.5,1.20710678}, {1.91421356,0.5,-1.20710678}, 
    {1.91421356,0.5,1.20710678}, {1.91421356,1.20710678,-0.5}, {1.91421356,1.20710678,0.5}],
    Faces = [[0,8,9,1], [1,3,5,7,6,4,2,0], [1,9,17,19,11,3], [2,10,18,16,8,0], [3,11,13,5], 
    [4,12,10,2], [5,13,21,23,15,7], [6,14,22,20,12,4], [7,15,14,6], [8,16,24,32,33,25,17,9], 
    [11,19,27,35,37,29,21,13], [12,20,28,36,34,26,18,10], [15,23,31,39,38,30,22,14], [17,25,27,19], 
    [18,26,24,16], [21,29,31,23], [22,30,28,20], [25,33,41,43,35,27], [26,34,42,40,32,24], 
    [29,37,45,47,39,31], [30,38,46,44,36,28], [32,40,41,33], [35,43,45,37], [36,44,42,34], 
    [39,47,46,38], [40,42,44,46,47,45,43,41]],
    {Verts,Faces}.

icosadodecahedron(false) ->
  Verts = [{-1.53884172,-0.5,0.0}, {-1.53884172,0.5,0.0}, {-1.37638187,0.0,-0.85065079}, 
  {-1.11351633,-0.80901699,0.85065079}, {-1.11351633,0.80901699,0.85065079}, {-0.95105648,-1.30901699,0.0}, 
  {-0.95105648,1.30901699,0.0}, {-0.85065079,0.0,1.37638187}, {-0.68819094,-0.5,-1.37638187}, 
  {-0.68819094,0.5,-1.37638187}, {-0.42532539,-1.30901699,-0.85065079}, 
  {-0.42532539,1.30901699,-0.85065079}, {-0.26286557,-0.80901699,1.37638187}, 
  {-0.26286557,0.80901699,1.37638187}, {0.0,-1.61803398,0.0}, {0.0,1.61803398,0.0}, 
  {0.26286557,-0.80901699,-1.37638187}, {0.26286557,0.80901699,-1.37638187}, {0.42532539,-1.30901699,0.85065079}, 
  {0.42532539,1.30901699,0.85065079}, {0.68819094,-0.5,1.37638187}, {0.68819094,0.5,1.37638187}, 
  {0.85065079,0.0,-1.37638187}, {0.95105648,-1.30901699,0.0}, {0.95105648,1.30901699,0.0}, 
  {1.11351633,-0.80901699,-0.85065079}, {1.11351633,0.80901699,-0.85065079}, {1.37638187,0.0,0.85065079}, 
  {1.53884172,-0.5,0.0}, {1.53884172,0.5,0.0}],
  Faces = [[0,3,7,4,1], [0,5,3], [1,2,0], [1,6,11,9,2], [2,8,10,5,0], [2,9,8], [3,12,7], 
  [4,6,1], [4,13,19,15,6], [5,14,18,12,3], [6,15,11], [7,13,4], [8,16,10], [9,17,22,16,8], 
  [10,14,5], [10,16,25,23,14], [11,17,9], [12,20,21,13,7], [13,21,19], [14,23,18], 
  [15,24,26,17,11], [17,26,22], [18,20,12], [18,23,28,27,20], [19,24,15], [20,27,21], 
  [21,27,29,24,19], [22,25,16], [22,26,29,28,25], [24,29,26], [25,28,23], [28,29,27]],
  {Verts,Faces};
icosadodecahedron(true) ->
    Verts = [{-3.73606796,-0.5,-0.5}, {-3.73606796,-0.5,0.5}, {-3.73606796,0.5,-0.5}, {-3.73606796,0.5,0.5}, 
    {-3.42705116,-1.0,-1.30901699}, {-3.42705116,-1.0,1.30901699}, {-3.42705116,1.0,-1.30901699}, 
    {-3.42705116,1.0,1.30901699}, {-3.11803398,-0.5,-2.11803398}, {-3.11803398,-0.5,2.11803398}, 
    {-3.11803398,0.5,-2.11803398}, {-3.11803398,0.5,2.11803398}, {-2.92705097,-1.80901699,-1.61803398}, 
    {-2.92705097,-1.80901699,1.61803398}, {-2.92705097,1.80901699,-1.61803398}, {-2.92705097,1.80901699,1.61803398}, 
    {-2.61803398,-1.30901699,-2.42705097}, {-2.61803398,-1.30901699,2.42705097}, {-2.61803398,1.30901699,-2.42705097}, 
    {-2.61803398,1.30901699,2.42705097}, {-2.42705097,-2.61803398,-1.30901699}, {-2.42705097,-2.61803398,1.30901699}, 
    {-2.42705097,2.61803398,-1.30901699}, {-2.42705097,2.61803398,1.30901699}, {-2.11803398,-3.11803398,-0.5}, 
    {-2.11803398,-3.11803398,0.5}, {-2.11803398,3.11803398,-0.5}, {-2.11803398,3.11803398,0.5}, {-1.80901699,-1.61803398,-2.92705097}, 
    {-1.80901699,-1.61803398,2.92705097}, {-1.80901699,1.61803398,-2.92705097}, {-1.80901699,1.61803398,2.92705097}, 
    {-1.61803398,-2.92705097,-1.80901699}, {-1.61803398,-2.92705097,1.80901699}, {-1.61803398,2.92705097,-1.80901699}, 
    {-1.61803398,2.92705097,1.80901699}, {-1.30901699,-3.42705116,-1.0}, {-1.30901699,-3.42705116,1.0}, 
    {-1.30901699,-2.42705097,-2.61803398}, {-1.30901699,-2.42705097,2.61803398}, {-1.30901699,2.42705097,-2.61803398}, 
    {-1.30901699,2.42705097,2.61803398}, {-1.30901699,3.42705116,-1.0}, {-1.30901699,3.42705116,1.0}, {-1.0,-1.30901699,-3.42705116}, 
    {-1.0,-1.30901699,3.42705116}, {-1.0,1.30901699,-3.42705116}, {-1.0,1.30901699,3.42705116}, {-0.5,-3.73606796,-0.5}, 
    {-0.5,-3.73606796,0.5}, {-0.5,-2.11803398,-3.11803398}, {-0.5,-2.11803398,3.11803398}, {-0.5,-0.5,-3.73606796}, 
    {-0.5,-0.5,3.73606796}, {-0.5,0.5,-3.73606796}, {-0.5,0.5,3.73606796}, {-0.5,2.11803398,-3.11803398}, {-0.5,2.11803398,3.11803398}, 
    {-0.5,3.73606796,-0.5}, {-0.5,3.73606796,0.5}, {0.5,-3.73606796,-0.5}, {0.5,-3.73606796,0.5}, {0.5,-2.11803398,-3.11803398}, 
    {0.5,-2.11803398,3.11803398}, {0.5,-0.5,-3.73606796}, {0.5,-0.5,3.73606796}, {0.5,0.5,-3.73606796}, {0.5,0.5,3.73606796}, 
    {0.5,2.11803398,-3.11803398}, {0.5,2.11803398,3.11803398}, {0.5,3.73606796,-0.5}, {0.5,3.73606796,0.5}, {1.0,-1.30901699,-3.42705116}, 
    {1.0,-1.30901699,3.42705116}, {1.0,1.30901699,-3.42705116}, {1.0,1.30901699,3.42705116}, {1.30901699,-3.42705116,-1.0}, 
    {1.30901699,-3.42705116,1.0}, {1.30901699,-2.42705097,-2.61803398}, {1.30901699,-2.42705097,2.61803398}, 
    {1.30901699,2.42705097,-2.61803398}, {1.30901699,2.42705097,2.61803398}, {1.30901699,3.42705116,-1.0}, {1.30901699,3.42705116,1.0},
    {1.61803398,-2.92705097,-1.80901699}, {1.61803398,-2.92705097,1.80901699}, {1.61803398,2.92705097,-1.80901699}, 
    {1.61803398,2.92705097,1.80901699}, {1.80901699,-1.61803398,-2.92705097}, {1.80901699,-1.61803398,2.92705097}, 
    {1.80901699,1.61803398,-2.92705097}, {1.80901699,1.61803398,2.92705097}, {2.11803398,-3.11803398,-0.5}, 
    {2.11803398,-3.11803398,0.5}, {2.11803398,3.11803398,-0.5}, {2.11803398,3.11803398,0.5}, {2.42705097,-2.61803398,-1.30901699}, 
    {2.42705097,-2.61803398,1.30901699}, {2.42705097,2.61803398,-1.30901699}, {2.42705097,2.61803398,1.30901699}, 
    {2.61803398,-1.30901699,-2.42705097}, {2.61803398,-1.30901699,2.42705097}, {2.61803398,1.30901699,-2.42705097}, 
    {2.61803398,1.30901699,2.42705097}, {2.92705097,-1.80901699,-1.61803398}, {2.92705097,-1.80901699,1.61803398}, 
    {2.92705097,1.80901699,-1.61803398}, {2.92705097,1.80901699,1.61803398}, {3.11803398,-0.5,-2.11803398}, 
    {3.11803398,-0.5,2.11803398}, {3.11803398,0.5,-2.11803398}, {3.11803398,0.5,2.11803398}, {3.42705116,-1.0,-1.30901699}, 
    {3.42705116,-1.0,1.30901699}, {3.42705116,1.0,-1.30901699}, {3.42705116,1.0,1.30901699}, {3.73606796,-0.5,-0.5}, 
    {3.73606796,-0.5,0.5}, {3.73606796,0.5,-0.5}, {3.73606796,0.5,0.5}],
    Faces = [[0,4,12,20,24,25,21,13,5,1], [1,3,2,0], [1,5,9,11,7,3], [2,6,10,8,4,0], [3,7,15,23,27,26,22,14,6,2], 
    [5,13,17,9], [6,14,18,10], [8,16,12,4], [9,17,29,45,53,55,47,31,19,11], [10,18,30,46,54,52,44,28,16,8], 
    [11,19,15,7], [13,21,33,39,29,17], [14,22,34,40,30,18], [16,28,38,32,20,12], [19,31,41,35,23,15], [20,32,36,24], 
    [23,35,43,27], [24,36,48,49,37,25], [25,37,33,21], [26,42,34,22], [27,43,59,58,42,26], [28,44,50,38], [31,47,57,41], 
    [32,38,50,62,78,84,76,60,48,36], [34,42,58,70,82,86,80,68,56,40], [37,49,61,77,85,79,63,51,39,33], [39,51,45,29], 
    [40,56,46,30], [41,57,69,81,87,83,71,59,43,35], [44,52,64,72,62,50], [46,56,68,74,66,54], [48,60,61,49], 
    [51,63,73,65,53,45], [53,65,67,55], [54,66,64,52], [55,67,75,69,57,47], [59,71,70,58], [60,76,92,93,77,61], 
    [63,79,89,73], [65,73,89,101,109,111,103,91,75,67], [66,74,90,102,110,108,100,88,72,64], [68,80,90,74], 
    [71,83,95,94,82,70], [72,88,78,62], [75,91,81,69], [77,93,97,85], [78,88,100,104,96,84], [81,91,103,107,99,87], 
    [82,94,98,86], [84,96,92,76], [85,97,105,101,89,79], [86,98,106,102,90,80], [87,99,95,83], 
    [92,96,104,112,116,117,113,105,97,93], [95,99,107,115,119,118,114,106,98,94], [100,108,112,104], [103,111,115,107], 
    [105,113,109,101], [106,114,110,102], [109,113,117,119,115,111], [110,114,118,116,112,108], [116,118,119,117]],
    {Verts,Faces}.

rhombi_hexaoctahedron(false) ->
  Verts = [{-1.20710678,-0.5,-0.5}, {-1.20710678,-0.5,0.5}, {-1.20710678,0.5,-0.5}, {-1.20710678,0.5,0.5}, 
  {-0.5,-1.20710678,-0.5}, {-0.5,-1.20710678,0.5}, {-0.5,-0.5,-1.20710678}, {-0.5,-0.5,1.20710678}, 
  {-0.5,0.5,-1.20710678}, {-0.5,0.5,1.20710678}, {-0.5,1.20710678,-0.5}, {-0.5,1.20710678,0.5}, 
  {0.5,-1.20710678,-0.5}, {0.5,-1.20710678,0.5}, {0.5,-0.5,-1.20710678}, {0.5,-0.5,1.20710678}, 
  {0.5,0.5,-1.20710678}, {0.5,0.5,1.20710678}, {0.5,1.20710678,-0.5}, {0.5,1.20710678,0.5}, 
  {1.20710678,-0.5,-0.5}, {1.20710678,-0.5,0.5}, {1.20710678,0.5,-0.5}, {1.20710678,0.5,0.5}],
  Faces = [[0,4,5,1], [0,6,4], [1,3,2,0], [1,7,9,3], [2,8,6,0], [2,10,8], [3,11,10,2], 
  [4,12,13,5], [5,7,1], [5,13,15,7], [6,14,12,4], [7,15,17,9], [8,16,14,6], [9,11,3], 
  [9,17,19,11], [10,18,16,8], [11,19,18,10], [12,20,21,13], [13,21,15], [14,20,12], 
  [15,21,23,17], [16,22,20,14], [17,23,19], [18,22,16], [19,23,22,18], [20,22,23,21]],
  {Verts,Faces};
rhombi_hexaoctahedron(true) -> 
    hexaoctahedron(true).

left_snub_hexaoctahedron(false) ->
  Verts = [{1.14261351,0.62122641,-0.33775396}, {1.14261351,0.33775396,0.62122641}, 
  {1.14261351,-0.33775396,-0.62122641}, {1.14261351,-0.62122641,0.33775396}, 
  {0.62122641,1.14261351,0.33775396}, {0.62122641,0.33775396,-1.14261351}, 
  {0.62122641,-0.33775396,1.14261351}, {0.62122641,-1.14261351,-0.33775396}, 
  {0.33775396,1.14261351,-0.62122641}, {0.33775396,0.62122641,1.14261351}, 
  {0.33775396,-0.62122641,-1.14261351}, {0.33775396,-1.14261351,0.62122641}, 
  {-0.33775396,1.14261351,0.62122641}, {-0.33775396,0.62122641,-1.14261351}, 
  {-0.33775396,-0.62122641,1.14261351}, {-0.33775396,-1.14261351,-0.62122641}, 
  {-0.62122641,1.14261351,-0.33775396}, {-0.62122641,0.33775396,1.14261351}, 
  {-0.62122641,-0.33775396,-1.14261351}, {-0.62122641,-1.14261351,0.33775396}, 
  {-1.14261351,0.62122641,0.33775396}, {-1.14261351,0.33775396,-0.62122641}, 
  {-1.14261351,-0.33775396,0.62122641}, {-1.14261351,-0.62122641,-0.33775396}],
  Faces = [[0,4,1], [0,8,4], [1,3,2,0], [1,6,3], [1,9,6], [2,5,0], [2,10,5], 
  [3,7,2], [3,11,7], [4,9,1], [4,12,9], [5,8,0], [5,13,8], [6,11,3], 
  [6,14,11], [7,10,2], [7,15,10], [8,16,12,4], [9,17,14,6], [10,18,13,5], 
  [11,19,15,7], [12,17,9], [12,20,17], [13,16,8], [13,21,16], [14,19,11], 
  [14,22,19], [15,18,10], [15,23,18], [16,20,12], [16,21,20], [17,22,14], 
  [18,21,13], [18,23,21], [19,23,15], [20,22,17], [21,23,22,20], [22,23,19]],
  {Verts,Faces};
left_snub_hexaoctahedron(true) -> 
    hexaoctahedron(true).

right_snub_hexaoctahedron(false) ->
  Verts = [{-1.14261351,-0.62122641,0.33775396}, {-1.14261351,-0.33775396,-0.62122641}, 
  {-1.14261351,0.33775396,0.62122641}, {-1.14261351,0.62122641,-0.33775396}, 
  {-0.62122641,-1.14261351,-0.33775396}, {-0.62122641,-0.33775396,1.14261351}, 
  {-0.62122641,0.33775396,-1.14261351}, {-0.62122641,1.14261351,0.33775396}, 
  {-0.33775396,-1.14261351,0.62122641}, {-0.33775396,-0.62122641,-1.14261351}, 
  {-0.33775396,0.62122641,1.14261351}, {-0.33775396,1.14261351,-0.62122641}, 
  {0.33775396,-1.14261351,-0.62122641}, {0.33775396,-0.62122641,1.14261351}, 
  {0.33775396,0.62122641,-1.14261351}, {0.33775396,1.14261351,0.62122641}, 
  {0.62122641,-1.14261351,0.33775396}, {0.62122641,-0.33775396,-1.14261351}, 
  {0.62122641,0.33775396,1.14261351}, {0.62122641,1.14261351,-0.33775396}, 
  {1.14261351,-0.62122641,-0.33775396}, {1.14261351,-0.33775396,0.62122641}, 
  {1.14261351,0.33775396,-0.62122641}, {1.14261351,0.62122641,0.33775396}],
  Faces = [[0,2,3,1], [0,5,2], [0,8,5], [1,4,0], [1,9,4], [2,7,3], [2,10,7], 
  [3,6,1], [3,11,6], [4,8,0], [4,12,16,8], [5,10,2], [5,13,18,10], [6,9,1], 
  [6,14,17,9], [7,11,3], [7,15,19,11], [8,13,5], [8,16,13], [9,12,4], 
  [9,17,12], [10,15,7], [10,18,15], [11,14,6], [11,19,14], [12,20,16], 
  [13,21,18], [14,22,17], [15,23,19], [16,21,13], [17,20,12], [17,22,20], 
  [18,23,15], [19,22,14], [19,23,22], [20,21,16], [20,22,23,21], [21,23,18]],
  {Verts,Faces};
right_snub_hexaoctahedron(true) -> 
    hexaoctahedron(true).

rhombi_icosadodecahedron(false) ->
  Verts = [{-2.11803398,-0.5,-0.5}, {-2.11803398,-0.5,0.5}, {-2.11803398,0.5,-0.5}, 
  {-2.11803398,0.5,0.5}, {-1.80901699,0.0,-1.30901699}, {-1.80901699,0.0,1.30901699}, 
  {-1.61803398,-1.30901699,-0.80901699}, {-1.61803398,-1.30901699,0.80901699}, 
  {-1.61803398,1.30901699,-0.80901699}, {-1.61803398,1.30901699,0.80901699}, 
  {-1.30901699,-1.80901699,0.0}, {-1.30901699,-0.80901699,-1.61803398}, 
  {-1.30901699,-0.80901699,1.61803398}, {-1.30901699,0.80901699,-1.61803398}, 
  {-1.30901699,0.80901699,1.61803398}, {-1.30901699,1.80901699,0.0}, 
  {-0.80901699,-1.61803398,-1.30901699}, {-0.80901699,-1.61803398,1.30901699}, 
  {-0.80901699,1.61803398,-1.30901699}, {-0.80901699,1.61803398,1.30901699}, 
  {-0.5,-2.11803398,-0.5}, {-0.5,-2.11803398,0.5}, {-0.5,-0.5,-2.11803398}, 
  {-0.5,-0.5,2.11803398}, {-0.5,0.5,-2.11803398}, {-0.5,0.5,2.11803398}, 
  {-0.5,2.11803398,-0.5}, {-0.5,2.11803398,0.5}, {0.0,-1.30901699,-1.80901699}, 
  {0.0,-1.30901699,1.80901699}, {0.0,1.30901699,-1.80901699}, 
  {0.0,1.30901699,1.80901699}, {0.5,-2.11803398,-0.5}, {0.5,-2.11803398,0.5}, 
  {0.5,-0.5,-2.11803398}, {0.5,-0.5,2.11803398}, {0.5,0.5,-2.11803398}, 
  {0.5,0.5,2.11803398}, {0.5,2.11803398,-0.5}, {0.5,2.11803398,0.5}, 
  {0.80901699,-1.61803398,-1.30901699}, {0.80901699,-1.61803398,1.30901699}, 
  {0.80901699,1.61803398,-1.30901699}, {0.80901699,1.61803398,1.30901699}, 
  {1.30901699,-1.80901699,0.0}, {1.30901699,-0.80901699,-1.61803398}, 
  {1.30901699,-0.80901699,1.61803398}, {1.30901699,0.80901699,-1.61803398}, 
  {1.30901699,0.80901699,1.61803398}, {1.30901699,1.80901699,0.0}, 
  {1.61803398,-1.30901699,-0.80901699}, {1.61803398,-1.30901699,0.80901699}, 
  {1.61803398,1.30901699,-0.80901699}, {1.61803398,1.30901699,0.80901699}, 
  {1.80901699,0.0,-1.30901699}, {1.80901699,0.0,1.30901699}, {2.11803398,-0.5,-0.5}, 
  {2.11803398,-0.5,0.5}, {2.11803398,0.5,-0.5}, {2.11803398,0.5,0.5}],
  Faces = [[0,6,10,7,1], [1,3,2,0], [1,5,3], [1,7,12,5], [2,4,0], [2,8,13,4], 
  [3,9,15,8,2], [4,11,6,0], [4,13,24,22,11], [5,14,9,3], [6,16,20,10], [7,17,12], 
  [8,18,13], [9,19,27,15], [10,21,17,7], [11,16,6], [11,22,28,16], [12,23,25,14,5], 
  [14,19,9], [14,25,31,19], [15,26,18,8], [15,27,26], [16,28,40,32,20], 
  [17,29,23,12], [18,30,24,13], [19,31,43,39,27], [20,21,10], [20,32,33,21], 
  [21,33,41,29,17], [22,34,28], [23,35,37,25], [24,36,34,22], [25,37,31], 
  [26,38,42,30,18], [27,39,38,26], [29,35,23], [29,41,46,35], [30,36,24], 
  [30,42,47,36], [32,44,33], [33,44,51,41], [34,45,40,28], [35,46,55,48,37], 
  [36,47,54,45,34], [37,48,43,31], [38,49,52,42], [39,49,38], [40,50,44,32], 
  [41,51,46], [42,52,47], [43,53,49,39], [45,50,40], [45,54,56,50], [48,53,43], 
  [48,55,59,53], [49,53,59,58,52], [50,56,57,51,44], [51,57,55,46], [52,58,54,47], 
  [54,58,56], [56,58,59,57], [57,59,55]],
  {Verts,Faces};
rhombi_icosadodecahedron(true) -> 
    icosadodecahedron(true).

left_snub_icosadodecahedron(false) ->
  Verts = [{-1.82011516,0.33092103,1.10693578}, {-1.85841173,-0.64302959,0.8834329}, 
  {-1.96471663,0.84755001,0.26302533}, {-2.02668169,-0.72833519,-0.09860997}, 
  {-1.32396975,-0.33092103,1.66890095}, {-2.09238171,0.19289371,-0.48204296}, 
  {-1.43668226,1.2495038,1.01109809}, {-1.10693594,0.64302959,1.734601}, 
  {-1.54298716,-1.45402422,0.39069052}, {-1.18135186,-1.2495038,1.30030104}, 
  {-1.72535978,1.10315685,-0.67365683}, {-1.38791839,1.64691792,0.09475529}, 
  {-1.7910598,-0.56771536,-1.05708982}, {-1.50832596,-1.41526537,-0.60795679}, 
  {-0.5044855,-0.84755001,1.91697369}, {-0.57890143,1.45402422,1.48267373}, 
  {-1.63599111,0.37482166,-1.353025}, {-0.15331744,0.72833519,2.02327862}, 
  {-0.85116807,-1.9778389,-0.10630498}, {-0.26602993,-1.64691792,1.3654758}, 
  {-0.9715756,1.74618645,-0.80901707}, {0.21901738,-0.19289371,2.13599118}, 
  {-0.5,2.09705391,0.0}, {-1.1398456,-0.37482166,-1.79105992}, {0.0,1.9778389,0.85778075}, 
  {-0.68237263,-1.74618645,-1.06434736}, {-0.06196513,-2.09705391,0.49614547}, 
  {0.45463924,-1.10315685,1.79554531}, {0.41634273,1.41526537,1.57204242}, 
  {-0.82697409,0.56771536,-1.90825785}, {0.82697409,0.56771536,1.90825785}, 
  {-0.41634273,1.41526537,-1.57204242}, {-0.45463924,-1.10315685,-1.79554531}, 
  {0.06196513,-2.09705391,-0.49614547}, {0.68237263,-1.74618645,1.06434736}, 
  {0.0,1.9778389,-0.85778075}, {1.1398456,-0.37482166,1.79105992}, {0.5,2.09705391,2 *math:exp(-08)}, 
  {-0.21901738,-0.19289371,-2.13599118}, {0.9715756,1.74618645,0.80901707}, 
  {0.26602993,-1.64691792,-1.3654758}, {0.85116807,-1.9778389,0.10630498}, 
  {0.15331744,0.72833519,-2.02327862}, {1.63599111,0.37482166,1.353025}, 
  {0.57890143,1.45402422,-1.48267373}, {0.5044855,-0.84755001,-1.91697369}, 
  {1.50832596,-1.41526537,0.60795679}, {1.7910598,-0.56771536,1.05708982}, 
  {1.38791839,1.64691792,-0.09475529}, {1.72535978,1.10315685,0.67365683}, 
  {1.18135186,-1.2495038,-1.30030104}, {1.54298716,-1.45402422,-0.39069052}, 
  {1.10693594,0.64302959,-1.734601}, {1.43668226,1.2495038,-1.01109809}, 
  {2.09238171,0.19289371,0.48204296}, {1.32396975,-0.33092103,-1.66890095}, 
  {2.02668169,-0.72833519,0.09860997}, {1.96471663,0.84755001,-0.26302533}, 
  {1.85841173,-0.64302959,-0.8834329}, {1.82011516,0.33092103,-1.10693578}],
  Faces = [[0,2,5,3,1], [0,6,2], [0,7,6], [1,4,0], [1,9,4], [2,10,5], 
  [2,11,10], [3,8,1], [3,13,8], [4,7,0], [4,14,21,17,7], [5,12,3], 
  [5,16,12], [6,11,2], [6,15,24,22,11], [7,15,6], [7,17,15], [8,9,1], 
  [8,18,26,19,9], [9,14,4], [9,19,14], [10,16,5], [10,20,31,29,16], 
  [11,20,10], [11,22,20], [12,13,3], [12,23,32,25,13], [13,18,8], 
  [13,25,18], [14,27,21], [15,28,24], [16,23,12], [16,29,23], [17,28,15], 
  [17,30,28], [18,33,26], [19,27,14], [19,34,27], [20,35,31], [21,30,17], 
  [21,36,30], [22,35,20], [22,37,35], [23,38,32], [24,37,22], [24,39,37], 
  [25,33,18], [25,40,33], [26,34,19], [26,41,34], [27,36,21], [28,39,24], 
  [29,38,23], [29,42,38], [30,43,49,39,28], [31,42,29], [31,44,42], 
  [32,40,25], [32,45,40], [33,41,26], [34,46,47,36,27], [35,44,31], 
  [36,43,30], [36,47,43], [37,48,53,44,35], [38,45,32], [39,48,37], 
  [39,49,48], [40,50,51,41,33], [41,46,34], [41,51,46], [42,52,55,45,38], 
  [43,54,49], [44,52,42], [44,53,52], [45,50,40], [45,55,50], [46,56,47], 
  [47,54,43], [47,56,54], [48,57,53], [49,57,48], [50,58,51], [51,56,46], 
  [51,58,56], [52,59,55], [53,59,52], [54,57,49], [55,58,50], [55,59,58], 
  [56,58,59,57,54], [57,59,53]],
  {Verts,Faces};
left_snub_icosadodecahedron(true) -> 
    icosadodecahedron(true).

right_snub_icosadodecahedron(false) ->
  Verts = [{-1.82011516,0.33092103,-1.10693578}, {-1.85841173,-0.64302959,-0.8834329}, 
  {-1.96471663,0.84755001,-0.26302533}, {-2.02668169,-0.72833519,0.09860997}, 
  {-1.32396975,-0.33092103,-1.66890095}, {-2.09238171,0.19289371,0.48204296}, 
  {-1.43668226,1.2495038,-1.01109809}, {-1.10693594,0.64302959,-1.734601}, 
  {-1.54298716,-1.45402422,-0.39069052}, {-1.18135186,-1.2495038,-1.30030104}, 
  {-1.72535978,1.10315685,0.67365683}, {-1.38791839,1.64691792,-0.09475529}, 
  {-1.7910598,-0.56771536,1.05708982}, {-1.50832596,-1.41526537,0.60795679}, 
  {-0.5044855,-0.84755001,-1.91697369}, {-0.57890143,1.45402422,-1.48267373}, 
  {-1.63599111,0.37482166,1.353025}, {-0.15331744,0.72833519,-2.02327862}, 
  {-0.85116807,-1.9778389,0.10630498}, {-0.26602993,-1.64691792,-1.3654758}, 
  {-0.9715756,1.74618645,0.80901707}, {0.21901738,-0.19289371,-2.13599118}, 
  {-0.5,2.09705391,2* math:exp(-08)}, {-1.1398456,-0.37482166,1.79105992}, {-3 * math:exp(-08),1.9778389,-0.85778075}, 
  {-0.68237263,-1.74618645,1.06434736}, {-0.06196513,-2.09705391,-0.49614547}, 
  {0.45463924,-1.10315685,-1.79554531}, {0.41634273,1.41526537,-1.57204242}, 
  {-0.82697409,0.56771536,1.90825785}, {0.82697409,0.56771536,-1.90825785}, 
  {-0.41634273,1.41526537,1.57204242}, {-0.45463924,-1.10315685,1.79554531}, 
  {0.06196513,-2.09705391,0.49614547}, {0.68237263,-1.74618645,-1.06434736}, 
  {0.0,1.9778389,0.85778075}, {1.1398456,-0.37482166,-1.79105992}, {0.5,2.09705391,0.0}, 
  {-0.21901738,-0.19289371,2.13599118}, {0.9715756,1.74618645,-0.80901707}, 
  {0.26602993,-1.64691792,1.3654758}, {0.85116807,-1.9778389,-0.10630498}, 
  {0.15331744,0.72833519,2.02327862}, {1.63599111,0.37482166,-1.353025}, 
  {0.57890143,1.45402422,1.48267373}, {0.5044855,-0.84755001,1.91697369}, 
  {1.50832596,-1.41526537,-0.60795679}, {1.7910598,-0.56771536,-1.05708982}, 
  {1.38791839,1.64691792,0.09475529}, {1.72535978,1.10315685,-0.67365683}, 
  {1.18135186,-1.2495038,1.30030104}, {1.54298716,-1.45402422,0.39069052}, 
  {1.10693594,0.64302959,1.734601}, {1.43668226,1.2495038,1.01109809}, 
  {2.09238171,0.19289371,-0.48204296}, {1.32396975,-0.33092103,1.66890095}, 
  {2.02668169,-0.72833519,-0.09860997}, {1.96471663,0.84755001,0.26302533}, 
  {1.85841173,-0.64302959,0.8834329}, {1.82011516,0.33092103,1.10693578}],
  Faces = [[0,4,1], [0,7,4], [1,3,5,2,0], [1,8,3], [1,9,8], [2,6,0], 
  [2,11,6], [3,12,5], [3,13,12], [4,9,1], [4,14,9], [5,10,2], [5,16,10], 
  [6,7,0], [6,15,7], [7,17,21,14,4], [8,13,3], [8,18,13], [9,19,26,18,8], 
  [10,11,2], [10,20,11], [11,22,24,15,6], [12,16,5], [12,23,16], 
  [13,25,32,23,12], [14,19,9], [14,27,19], [15,17,7], [15,28,17], 
  [16,29,31,20,10], [17,30,21], [18,25,13], [18,33,25], [19,34,26], 
  [20,22,11], [20,35,22], [21,27,14], [21,36,27], [22,37,24], [23,29,16], 
  [23,38,29], [24,28,15], [24,39,28], [25,40,32], [26,33,18], [26,41,33], 
  [27,34,19], [27,36,47,46,34], [28,30,17], [28,39,49,43,30], [29,42,31], 
  [30,36,21], [30,43,36], [31,35,20], [31,44,35], [32,38,23], [32,45,38], 
  [33,40,25], [33,41,51,50,40], [34,41,26], [34,46,41], [35,37,22], 
  [35,44,53,48,37], [37,39,24], [37,48,39], [38,42,29], [38,45,55,52,42], 
  [40,45,32], [40,50,45], [42,44,31], [42,52,44], [43,47,36], [43,54,47], 
  [46,51,41], [46,56,51], [47,56,46], [48,49,39], [48,57,49], [49,54,43], 
  [49,57,54], [50,55,45], [50,58,55], [51,58,50], [52,53,44], [52,59,53], 
  [53,57,48], [53,59,57], [54,56,47], [54,57,59,58,56], [55,59,52], 
  [56,58,51], [58,59,55]],
  {Verts,Faces};
right_snub_icosadodecahedron(true) -> 
    icosadodecahedron(true).

get_pref(Key, Def) ->
    wpa:pref_get(?MODULE, Key, Def).

compare_min_max({X,Y,Z},[{MinX,MinY,MinZ},{MaxX,MaxY,MaxZ}]) ->  
    if
        X < MinX -> MinX1 = X;
        true -> MinX1 = MinX
    end,
    if
        Y < MinY -> MinY1 = Y;
        true -> MinY1 = MinY
    end,
    if
        Z < MinZ -> MinZ1 = Z;
        true -> MinZ1 = MinZ
    end,
    if
        X > MaxX -> MaxX1 = X;
        true -> MaxX1 = MaxX
    end,
    if
        Y > MaxY -> MaxY1 = Y;
        true -> MaxY1 = MaxY
    end,
    if
        Z > MaxZ -> MaxZ1 = Z;
        true -> MaxZ1 = MaxZ
    end,

    [{MinX1,MinY1,MinZ1},{MaxX1,MaxY1,MaxZ1}].

find_min_max(List,MinMax0) ->
    case List of
        [] -> MinMax0;
        [H | T] -> MinMax = compare_min_max(H,MinMax0),
                    find_min_max(T,MinMax)
    end.

transform(List, Mat) ->
    case List of
        [] -> [];
        [H|T] -> [e3d_mat:mul_point(Mat,H)] ++ transform(T,Mat)
    end.

normalize(Vrs) ->
    [Min, Max] = find_min_max(Vrs,[{0.0,0.0,0.0}, {0.0,0.0,0.0}]),

    % Size -> size of the cube enclosing We
    {X,Y,Z} = e3d_vec:sub(Max, Min),
    if 
        Y < Z, X < Z -> Size = {Z,Z,Z};
        X < Y -> Size = {Y,Y,Y};
        true -> Size = {X,X,X}
    end,

    Scale =  e3d_vec:len({2.0,2.0,2.0}) / e3d_vec:len(Size),
    Matrix = e3d_mat:scale(Scale),
    transform(Vrs, Matrix).

